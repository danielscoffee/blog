{{- if hugo.IsMultilingual }}
<div class="language-switcher">
  <button class="lang-toggle" aria-label="Select language">
    <span class="current-lang">{{ .Language.LanguageName }}</span>
    <svg class="lang-icon" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M4 6L8 10L12 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </button>
  <div class="lang-dropdown">
    {{- $currentPage := . }}
    {{- range site.Home.AllTranslations }}
      {{- $targetLang := .Language.Lang }}
      {{- $isCurrentLang := eq $targetLang $currentPage.Language.Lang }}
      {{- $url := .RelPermalink }}
      {{- if $isCurrentLang }}
        {{- $url = $currentPage.RelPermalink }}
      {{- else if $currentPage.IsTranslated }}
        {{- range $currentPage.Translations }}
          {{- if eq .Language.Lang $targetLang }}
            {{- $url = .RelPermalink }}
          {{- end }}
        {{- end }}
      {{- else }}
        {{- $url = .RelPermalink }}
      {{- end }}
      <a href="{{ $url }}" 
         lang="{{ $targetLang }}" 
         class="lang-link {{ if $isCurrentLang }}active{{ end }}">
        {{ .Language.LanguageName }}
      </a>
    {{- end }}
  </div>
</div>
{{- end }}